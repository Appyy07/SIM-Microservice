# =================================================================
# SIM MICROSERVICE CONFIGURATION
# =================================================================

# Server Configuration
server:
  port: ${SERVER_PORT:8080}

spring:
  application:
    name: sim-microservice
  
  # =================================================================
  # DATABASE CONFIGURATION
  # Uses H2 for local development, PostgreSQL for production
  # =================================================================
  datasource:
    # H2 for local development (change to PostgreSQL in production)
    url: ${DB_URL:jdbc:h2:mem:simdb}
    driver-class-name: ${DB_DRIVER:org.h2.Driver}
    username: ${DB_USERNAME:sa}
    password: ${DB_PASSWORD:}
  
  jpa:
    database-platform: ${DB_DIALECT:org.hibernate.dialect.H2Dialect}
    hibernate:
      ddl-auto: ${DDL_AUTO:update}  # Creates/updates tables automatically
    show-sql: ${SHOW_SQL:true}
    properties:
      hibernate:
        format_sql: true
  
  # H2 Console (Web interface to view database)
  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:true}
      path: /h2-console

# =================================================================
# ACTUATOR CONFIGURATION (Health Checks for Kubernetes)
# =================================================================
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true
  health:
    livenessState:
      enabled: true
    readinessState:
      enabled: true

# =================================================================
# LOGGING CONFIGURATION
# =================================================================
logging:
  level:
    root: INFO
    com.example.sim: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE

# =================================================================
# SOUTHBOUND ENDPOINTS CONFIGURATION
# All backend URLs/protocols externalized - NO HARDCODING!
# Can be overridden by Kubernetes ConfigMap
# =================================================================
southbound:
  endpoints:
    # Backend 1: REST endpoint
    backend1:
      url: ${BACKEND1_URL:http://httpbin.org/post}
      protocol: ${BACKEND1_PROTOCOL:REST}
      timeout: ${BACKEND1_TIMEOUT:5000}
      enabled: ${BACKEND1_ENABLED:true}
    
    # Backend 2: SOAP endpoint
    backend2:
      url: ${BACKEND2_URL:http://www.dneonline.com/calculator.asmx}
      protocol: ${BACKEND2_PROTOCOL:SOAP}
      timeout: ${BACKEND2_TIMEOUT:5000}
      enabled: ${BACKEND2_ENABLED:true}
    
    # Backend 3: REST endpoint
    backend3:
      url: ${BACKEND3_URL:http://httpbin.org/anything}
      protocol: ${BACKEND3_PROTOCOL:REST}
      timeout: ${BACKEND3_TIMEOUT:5000}
      enabled: ${BACKEND3_ENABLED:true}
    
    # Backend 4: SOAP endpoint
    backend4:
      url: ${BACKEND4_URL:http://www.dataaccess.com/webservicesserver/NumberConversion.wso}
      protocol: ${BACKEND4_PROTOCOL:SOAP}
      timeout: ${BACKEND4_TIMEOUT:5000}
      enabled: ${BACKEND4_ENABLED:true}

# =================================================================
# SWAGGER/OPENAPI CONFIGURATION
# Generates API documentation at /swagger-ui.html
# =================================================================
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha

# =================================================================
# APPLICATION METADATA
# =================================================================
app:
  name: SIM Microservice
  version: 1.0.0
  description: Microservice for managing SIM records with REST/SOAP protocols